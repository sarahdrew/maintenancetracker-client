(window.webpackJsonpmaintenancetracker=window.webpackJsonpmaintenancetracker||[]).push([[0],{24:function(e,t,n){e.exports=n(35)},34:function(e,t,n){},35:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(19),c=n.n(o),s=n(1),l=n(2),i=n(4),u=n(3),m=n(5),d=n(12),p=function(e){function t(){return Object(s.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"explanation"},r.a.createElement("h2",null,"MaintenanceTracker"),r.a.createElement("h3",null,"A space for landlords and tenants to communicate efficiently"),"How to get started:",r.a.createElement("ul",null,r.a.createElement("li",null,"Register for an account"),r.a.createElement("li",null,"Sign in witth account credentials"),r.a.createElement("li",null,"Check listings to update status or create a listing"))))}}]),t}(a.Component),h={API_ENDPOINT:"http://localhost:8000",TOKEN_KEY:"tokenKey"},E={saveAuthToken:function(e){window.localStorage.setItem(h.TOKEN_KEY,e)},getAuthToken:function(){return window.localStorage.getItem(h.TOKEN_KEY)},clearAuthToken:function(){window.localStorage.removeItem(h.TOKEN_KEY)},hasAuthToken:function(){return!!E.getAuthToken()},makeBasicAuthToken:function(e,t){return window.btoa("".concat(e,":").concat(t))}},f=E,b={getAllRequests:function(){return fetch("".concat(h.API_ENDPOINT,"/api/requests")).then(function(e){return e.ok?e.json():e.json().then(function(e){return Promise.reject(e)})}).then(function(e){return console.log("responseJson to put on the page: ",e),e}).then(function(e){return e})},getRequest:function(e){return console.log("request-api-srevice requestsId: ",e),fetch("".concat(h.API_ENDPOINT,"/api/requests/").concat(e),{headers:{authorization:"basic ".concat(f.getAuthToken())}}).then(function(e){return e.ok?e.json():e.json().then(function(e){return Promise.reject(e)})}).then(function(e){return e}).then(function(e){return e})}},g=r.a.createContext(),v=n(6),q=function(e){function t(){return Object(s.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;b.getAllRequests().then(function(t){return e.context.setRequests(t)}).catch(function(e){return console.error(e)})}},{key:"render",value:function(){return console.log(this.context.requests),r.a.createElement("div",{className:"total-request-item"},r.a.createElement("div",{className:"request-content"},r.a.createElement("header",{className:"totalRequestItem__header"},r.a.createElement("h2",null," All requests for landlord:")),this.context.requests.map(function(e,t){return r.a.createElement("div",{key:t,className:"requests"},"---------------------------------------",r.a.createElement("p",null,r.a.createElement(v.b,{to:"/requests/".concat(e.id)}," Request Title: ",e.title)),r.a.createElement("p",null,e.description),"---------------------------------------")})))}}]),t}(a.Component);q.contextType=g;var j={postUser:function(e){return fetch("".concat(h.API_ENDPOINT,"/api/users"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(e)}).then(function(e){return e.json()}).catch(function(e){console.log(e)})},postLogin:function(e){var t=e.email,n=e.password;return fetch("".concat(h.API_ENDPOINT,"/api/auth/login"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({email:t,password:n})}).then(function(e){return e.ok?e.json():e.json().then(function(e){return Promise.reject(e)})}).then(function(e){return f.saveAuthToken(e.authToken),e}).catch(function(e){})},postRefreshToken:function(){return fetch("".concat(h.API_ENDPOINT,"/api/auth/refresh"),{method:"POST",headers:{authorization:"Bearer ".concat(f.getAuthToken())}}).then(function(e){return e.ok?e.json():e.json().then(function(e){return Promise.reject(e)})}).then(function(e){return f.saveAuthToken(e.authToken),f.queueCallbackBeforeExpiry(function(){j.postRefreshToken()}),e}).catch(function(e){console.error(e)})}},O=j,N=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={error:null},n.handleSubmit=function(e){e.preventDefault(),console.log("handling the submit for registration");var t=e.target,a=t.full_name,r=t.email,o=t.password,c=t.landlord_tenant;console.log("full name: ",a,"landlord_tenant:",c),n.setState({error:null}),O.postUser({email:r.value,password:o.value,full_name:a.value,landlord_tenant:c.value}).then(function(e){a.value="",r.value="",o.value="",c.value="",console.log("push history to sign in"),n.props.onRegistrationSuccess(),n.props.history.push("/sign-in")}).catch(function(e){console.log("res",e),n.setState({error:e.error})})},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.state.error;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"headline"},r.a.createElement("h3",null,"Register for an account")),r.a.createElement("div",{className:"total-registration-form"},r.a.createElement("form",{className:"RegistrationForm",onSubmit:this.handleSubmit},r.a.createElement("div",{role:"alert"},e&&r.a.createElement("p",{className:"red"},Object.keys(e))),r.a.createElement("div",{className:"landlord_tenant"},r.a.createElement("p",null,r.a.createElement("label",{htmlFor:"landlord_tenant"},"Landlord   "),r.a.createElement("input",{type:"radio",name:"landlord_tenant",required:!0,id:"RegistrationForm__landlord",value:"landlord"})),r.a.createElement("p",null,r.a.createElement("label",{htmlFor:"tenant_tenant"},"       Tenant"),r.a.createElement("input",{type:"radio",name:"landlord_tenant",required:!0,id:"RegistrationForm__tenant",value:"tenant"}))),r.a.createElement("div",{className:"full_name"},r.a.createElement("label",{htmlFor:"RegistrationForm__full_name"},"Full name"),r.a.createElement("input",{type:"text",name:"full_name",required:!0,id:"RegistrationForm__full_name"})),r.a.createElement("div",{className:"email"},r.a.createElement("label",{htmlFor:"RegistrationForm__email"},"Email"),r.a.createElement("input",{type:"text",name:"email",required:!0,id:"RegistrationForm__email"})),r.a.createElement("div",{className:"password"},r.a.createElement("p",null,r.a.createElement("i",null,"Password must be at least 8 characters long, contain a special character, one upper case letter and one lower case letter.")),r.a.createElement("label",{htmlFor:"RegistrationForm__password"},"Password"),r.a.createElement("input",{type:"password",name:"password",required:!0,id:"RegistrationForm__password"})),r.a.createElement("button",{type:"submit"}," Register"))))}}]),t}(a.Component);N.defaultProps={onRegistrationSuccess:function(){}};var y=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={error:null},n.handleSubmitBasicAuth=function(e){e.preventDefault();var t=e.target,a=t.email,r=t.password;f.saveAuthToken(f.makeBasicAuthToken(a.value,r.value)),O.postLogin({email:a.value,password:r.value}).then(function(e){a.value="",r.value="",n.props.onSigninSuccess(),console.log("pushing to signed in page"),n.setState({isSignedIn:!0}),n.props.history.push("/signed-in")}).catch(function(e){})},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.state.error;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"demo-explanation"},r.a.createElement("p",null,"For a demo, use the following credentials:"),r.a.createElement("p",null,"email: demo@maintenancetracker.com"),r.a.createElement("p",null,"Password: Demo123!")),r.a.createElement("form",{className:"SigninForm",onSubmit:this.handleSubmitBasicAuth},r.a.createElement("div",{role:"alert"},e&&r.a.createElement("p",{className:"red"},e)),r.a.createElement("div",{className:"email"},r.a.createElement("label",{htmlFor:"SigninForm__email"},"email"),r.a.createElement("input",{type:"text",required:!0,name:"email",id:"SigninForm__email"})),r.a.createElement("div",{className:"password"},r.a.createElement("label",{htmlFor:"SigninForm__password"},"Password"),r.a.createElement("input",{required:!0,name:"password",type:"password",id:"SigninForm__password"})),r.a.createElement("button",{type:"submit"},"Sign In")))}}]),t}(a.Component);y.defaultProps={onSigninSuccess:function(){},isSignedIn:!1};var k=n(23),S=r.a.createContext({requests:[],addRequest:function(){},updateRequests:function(){}}),T=n(22);function _(e){var t=e.className,n=Object(T.a)(e,["className"]);return r.a.createElement("form",Object.assign({className:["Requests-form",t].join(" "),action:"#"},n))}var R=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(i.a)(this,Object(u.a)(t).call(this,e))).addRequest=function(e){n.setState({requests:[].concat(Object(k.a)(n.state.request),[e])})},n.handleSubmit=function(e){e.preventDefault(),console.log("handleSubmit for create request begins");var t={title:e.target.title.value,description:e.target.description.value};console.log("config.API_ENDPOINT: ",h.API_ENDPOINT),fetch("".concat(h.API_ENDPOINT,"/api/requests"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"bearer ".concat(f.getAuthToken())},body:JSON.stringify(t)}).then(function(e){return e.ok?e.json():e.json().then(function(e){return Promise.reject(e)})}).then(function(e){n.context.addRequest(e),n.props.history.push("/request-sent")}).catch(function(e){console.error({error:e})})},n.state={title:"",description:""},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"updateRequests",value:function(e,t){this.setState({title:e,description:t})}},{key:"render",value:function(){var e=this;return r.a.createElement("section",{className:"create-request"},r.a.createElement("h1",null,"Offer your space"),r.a.createElement("p",null,"You can create your request as a signed in tenant. Enter in your request below."),r.a.createElement(_,{onSubmit:this.handleSubmit},r.a.createElement("div",{className:"field"},r.a.createElement("label",{htmlFor:"title"},"Title"),r.a.createElement("input",{placeholder:"Leaky faucet",type:"text",name:"title",id:"title",onChange:function(t){return e.updateRequests(t.target.value)}})),r.a.createElement("div",{className:"field"},r.a.createElement("label",{htmlFor:"description"},"Description:"),r.a.createElement("input",{type:"text",name:"description",id:"description",placeholder:"Faucet in the bathroom leaks when tap is off",onChange:function(t){return e.updateRequests(t.target.value)}})),r.a.createElement("button",{type:"submit",onSubmit:this.handleSubmit},"Send my request")))}}]),t}(a.Component);R.defaultProps={history:{push:function(){}}},R.contextType=S;var A=function(e){function t(){return Object(s.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"signed-in"},r.a.createElement("h2",null,"Successfully signed in!"))}}]),t}(a.Component),w=function(e){function t(){return Object(s.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return f.hasAuthToken()?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"Nav"},r.a.createElement("div",{className:"nav-name"},"MAINTENANCETRACKER")),r.a.createElement("div",{className:"links"},r.a.createElement(v.b,{to:"/"},"Home"),"|",r.a.createElement(v.b,{to:"/register"},"Register ")," |",r.a.createElement(v.b,{to:"sign-in"},"Sign In ")," |",r.a.createElement(v.b,{to:"/requests"}," All Requests")," |",r.a.createElement(v.b,{to:"/create-request"},"Create Request"))):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"Nav"},r.a.createElement("div",{className:"nav-name"},"MAINTENANCETRACKER")),r.a.createElement("div",{className:"links"},r.a.createElement(v.b,{to:"/"},"Home"),"|",r.a.createElement(v.b,{to:"/register"},"Register ")," |",r.a.createElement(v.b,{to:"sign-in"},"Sign In ")))}}]),t}(a.Component),P=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(i.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault(),console.log("handleSubmit for update tracker begins"),console.log("description: ",e.target.status.value);var t={title:n.context.request.title,description:n.context.request.description,status:e.target.status.value,id:n.context.request.id};fetch("".concat(h.API_ENDPOINT,"/api/requests/").concat(n.context.request.id),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"bearer ".concat(f.getAuthToken())},body:JSON.stringify(t)}).then(function(e){return console.log(e),e.ok?e.json():e.json().then(function(e){return Promise.reject(e)})}).then(function(e){console.log("UPDate: ",e),n.context.updateRequests(e)}).catch(function(e){console.error({error:e})})},n.state={title:"",description:"",status:"",updated:!1},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"updateRequests",value:function(e){this.setState({status:e,updated:!0})}},{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.requestsId;b.getRequest(t).then(function(t){return e.context.setRequest(t)}).catch(function(e){return console.error(e)})}},{key:"renderRequest",value:function(){var e=this.context.request;return console.log("request: ",{request:e}),r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Title: "),e.title,r.a.createElement("p",null," ",r.a.createElement("b",null,"Description: "),e.description),this.context.request.status&&r.a.createElement("div",null,"State: ",this.context.request.status,r.a.createElement("br",null),r.a.createElement("br",null)),r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("label",{htmlFor:"status"},"What's the status?"),r.a.createElement("input",{type:"radio",name:"status",value:"received"})," project received",r.a.createElement("input",{type:"radio",name:"status",value:"started"})," project started",r.a.createElement("input",{type:"radio",name:"status",value:"completed"})," project completed",r.a.createElement("button",{type:"submit"}," Update progress")))}},{key:"renderUpdatedRequest",value:function(){var e=this.context.request;return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Title: "),e.title,r.a.createElement("p",null," ",r.a.createElement("b",null,"Description: "),e.description),r.a.createElement("p",null,"Status: ",e.status))}},{key:"render",value:function(){var e;return console.log(this.context),e=void 0===this.context.request?r.a.createElement("div",{className:"loading"}):this.renderRequest(),r.a.createElement("div",{className:"request-page"},e)}}]),t}(a.Component);P.defaultProps={match:{params:{}}},P.contextType=g;var I=function(e){function t(){return Object(s.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return console.log("this.context.requests",this.context.requests),r.a.createElement("div",{className:"signed-in"},r.a.createElement("h2",null,"Your Request has been sent"),r.a.createElement(v.b,{to:"/requests/:requestsId"}," Check on or update the status of your request "))}}]),t}(a.Component);I.contextType=g;var x=function(e){function t(){return Object(s.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"Nav"},r.a.createElement("div",{className:"nav-name"},"MAINTENANCETRACKER")),r.a.createElement("div",{className:"links"},r.a.createElement(v.b,{to:"/"},"Home"),"|",r.a.createElement(v.b,{to:"/register"},"Register ")," |",r.a.createElement(v.b,{to:"/requests"}," All Requests")," |",r.a.createElement(v.b,{to:"/create-request"},"Create Request")))}}]),t}(a.Component),F=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(i.a)(this,Object(u.a)(t).call(this))).state={requests:[],request:"",isSignedIn:!1,setRequest:function(t){e.setState({request:t})},setRequests:function(t){e.setState({requests:t})},updateRequests:function(t){e.setState({request:t})}},e}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(g.Provider,{value:this.state},r.a.createElement("nav",null,this.state.isSignedIn?r.a.createElement(x,null):r.a.createElement(w,null)),r.a.createElement("main",{className:"App"},r.a.createElement(d.a,{exact:!0,path:"/",component:p}),r.a.createElement(d.a,{exact:!0,path:"/requests",component:q}),r.a.createElement(d.a,{path:"/register",component:N}),r.a.createElement(d.a,{path:"/sign-in",component:y}),r.a.createElement(d.a,{path:"/create-request",component:R}),r.a.createElement(d.a,{path:"/signed-in",component:A}),r.a.createElement(d.a,{path:"/requests/:requestsId",component:P}),r.a.createElement(d.a,{path:"/request-sent",component:I}))))}}]),t}(a.Component);n(34);console.log(Object({NODE_ENV:"production",PUBLIC_URL:""})),c.a.render(r.a.createElement(function(){return r.a.createElement(v.a,null,r.a.createElement(F,null))},null),document.getElementById("root"))}},[[24,1,2]]]);
//# sourceMappingURL=main.d5b2a1b3.chunk.js.map